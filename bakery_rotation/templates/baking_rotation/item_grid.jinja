{% load static %}

{% block content %}
  <div class="row">
    {% for item in items %}
      <div class="col-3 my-2">
        <a class="grid-item-box" href="/bakery_rotation/details/{{ item.id }}">
          <div class="grid-item">
            <div class="grid-img-container">
              {% if request.path == '/yours/' %}
              <form method='post' enctype='multipart/form-data' class='form-grid-buttons'>
                {% csrf_token %}
                <div>
                  <div>
                    <input type="file" id="image-input" name="image" accept="image/*" class="inputfile" />
                    <label for="image-input" id="image-edit-button" class="btn btn-info btn-sm">Edit</label>
                    <span id="image-input-name"></span>
                  </div>
                  <input name="pk" value="{{ item.pk }}" type="hidden" />
                  <button id="image-update-button" type="submit" value="OK" class="btn btn-success btn-sm">Update</button>
                </div>
              </form>
              {% endif %}

              {% if item.image %}
                <img src="{{ item.image.url }}" class="img-item">
              {% else %}
                <img src="{% static 'baking_rotation/images/question-mark.png' %}" class="img-item">
              {% endif %}

            </div>
            <div class="grid-item-description">
              <div class="grid-item-title">
                <span>{{ item.item | title }}</span>
              </div>
              <div class="pt-1">
                <span class="grid-item-date">{{ item.pretty_time }}</span>
              </div>
            </div>
          </div>
        </a>
      </div>
    {% endfor %}
  </div>
{% endblock %}

{% block javascript %}
  <script type="text/javascript">
    var imageInput = document.getElementById('image-input')
    var imageEditButton = document.getElementById('image-edit-button')
    var imageUpdateButton = document.getElementById('image-update-button')
    var imageInputName = document.getElementById('image-input-name')

    imageInput.onchange = (e) => {
      var fileName = e.target.files[0].name
      imageInputName.innerHTML = fileName
      imageUpdateButton.setAttribute("style", "display:inline-block;");
    }

  </script>
{% endblock %}
